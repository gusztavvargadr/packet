parameters:
  samples: []
    # - name: [ sample-name-part-1, sample-name-part-2, ... ]

stages:
  - template: ./sample.azure-pipelines.stages.build.yml
    parameters:
      name: commit
      displayName: Commit
      samples: ${{ parameters.samples }}

  - template: ./sample.azure-pipelines.stages.deploy.yml
    parameters:
      name: acceptance
      displayName: Acceptance
      samples: ${{ parameters.samples }}

  - template: ./sample.azure-pipelines.stages.deploy.yml
    parameters:
      name: staging
      displayName: Staging
      condition: and(succeeded(), or(eq(variables['Build.SourceBranch'], 'refs/heads/master'), startsWith(variables['Build.SourceBranch'], 'refs/tags/')))
      samples: ${{ parameters.samples }}
      packageRegistry: github-gusztavvargadr

  - template: ./sample.azure-pipelines.stages.deploy.yml
    parameters:
      name: production
      displayName: Production
      condition: and(succeeded(), startsWith(variables['Build.SourceBranch'], 'refs/tags/'))
      samples: ${{ parameters.samples }}
      packageRegistry: dockerhub-gusztavvargadr
